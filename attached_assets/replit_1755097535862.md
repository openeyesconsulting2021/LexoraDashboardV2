# Legal Office Management System

## Overview

This is a comprehensive legal office management system built with modern web technologies. The application provides a complete solution for managing legal cases, clients, documents, tasks, and users in a law office environment. It features a full-stack architecture with a React frontend and Express backend, using PostgreSQL for data persistence.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

### Frontend Architecture
- **Framework**: React with TypeScript
- **Build Tool**: Vite for fast development and optimized builds
- **UI Library**: Radix UI components with shadcn/ui styling system
- **Styling**: Tailwind CSS with custom theme variables
- **State Management**: TanStack Query (React Query) for server state management
- **Routing**: Wouter for lightweight client-side routing
- **Forms**: React Hook Form with Zod validation
- **Language Support**: Right-to-left (RTL) Arabic interface

### Backend Architecture
- **Runtime**: Node.js with Express.js framework
- **Language**: TypeScript with ES modules
- **Database ORM**: Drizzle ORM with PostgreSQL
- **Authentication**: JWT-based authentication with bcrypt password hashing
- **File Upload**: Multer middleware for document management
- **API Design**: RESTful API with role-based access control

### Database Architecture
- **Database**: PostgreSQL (configured for Neon serverless)
- **Schema Management**: Drizzle ORM with migration support
- **Connection**: Connection pooling with @neondatabase/serverless

## Key Components

### Authentication & Authorization
- JWT token-based authentication
- Role-based access control (admin, lawyer, secretary)
- Middleware for protected routes
- Session management with automatic token refresh

### User Management
- Multi-role user system (admin, lawyer, secretary)
- User activation/deactivation
- Profile management
- Audit logging for user activities

### Case Management
- Case creation and tracking
- Case status management (active, pending, closed)
- Priority levels (low, medium, high, urgent)
- Court information tracking
- Client and lawyer assignment

### Client Management
- Client registration and profiles
- Contact information management
- Case history tracking
- Document association

### Document Management
- File upload and storage
- Document categorization
- Case and client association
- File type validation and size limits
- Download and preview capabilities

### Task Management
- Task creation and assignment
- Due date tracking
- Priority management
- Status updates (pending, in-progress, completed)
- Case association

### Audit System
- Comprehensive audit logging
- User activity tracking
- Data change history
- System monitoring

## Data Flow

### Authentication Flow
1. User submits credentials via login form
2. Backend validates credentials against database
3. JWT token generated and returned to client
4. Token stored in localStorage and used for subsequent requests
5. Middleware validates token on protected routes

### CRUD Operations Flow
1. Client initiates request through React components
2. TanStack Query manages request state and caching
3. API requests sent to Express backend with authentication
4. Backend validates permissions and processes request
5. Drizzle ORM handles database operations
6. Response returned to client with updated data
7. UI updates automatically through reactive queries

### File Upload Flow
1. User selects files through document modal
2. Files validated on client-side for type and size
3. FormData sent to backend via multipart/form-data
4. Multer middleware processes file upload
5. Files stored in uploads directory
6. Database records created with file metadata

## External Dependencies

### Frontend Dependencies
- **UI Components**: @radix-ui/* for accessible components
- **State Management**: @tanstack/react-query for server state
- **Form Handling**: react-hook-form with @hookform/resolvers
- **Validation**: zod for schema validation
- **Styling**: tailwindcss with class-variance-authority
- **Icons**: lucide-react for consistent iconography
- **Development**: @replit/vite-plugin-* for Replit integration

### Backend Dependencies
- **Database**: @neondatabase/serverless for PostgreSQL connection
- **ORM**: drizzle-orm with drizzle-kit for schema management
- **Authentication**: jsonwebtoken and bcrypt for security
- **File Upload**: multer for handling multipart/form-data
- **Development**: tsx for TypeScript execution

### Build Tools
- **Bundling**: Vite for frontend, esbuild for backend
- **TypeScript**: Full TypeScript support across the stack
- **Development**: Hot module replacement and file watching

## Deployment Strategy

### Production Build
- Frontend built with Vite to optimized static assets
- Backend compiled with esbuild for Node.js execution
- TypeScript compiled to JavaScript with module resolution
- Assets served statically in production

### Database Setup
- Drizzle migrations for schema deployment
- Environment-based configuration
- Connection pooling for production scalability

### Environment Configuration
- DATABASE_URL for PostgreSQL connection
- JWT_SECRET for token signing
- NODE_ENV for environment-specific behavior
- File upload directory configuration

### Development Workflow
- Hot reload for both frontend and backend
- Automatic TypeScript compilation
- Database schema synchronization
- Integrated development server with proxy

The system is designed to be scalable, maintainable, and user-friendly, with a focus on providing a comprehensive solution for legal office management while maintaining high security standards and performance.